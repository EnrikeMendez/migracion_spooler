parametros (string rep_id)

SELECT REP.NAME, REP.CLIENTE
 , REP.FILE_NAME, REP.CARPETA
 , CLI.CLINOM
 , mail.NOMBRE, mail.MAIL
 , REPORT.COMMAND
 , REP.DAYS_DELETED
 , REPORT.NUM_OF_PARAM
 , REP.DEST_MAIL, to_char(REP.LAST_CONF_DATE_1, 'mm/dd/yyyy') LAST_CONF_DATE_1, to_char(REP.LAST_CONF_DATE_2, 'mm/dd/yyyy') LAST_CONF_DATE_2
    ,REP.PARAM_1,REP.PARAM_2,REP.PARAM_3,REP.PARAM_4
  , mail.client_num
  , REPORT.ID_REP, REPORT.SUBCARPETA
  , REP.CREATED_BY
  ,TERCERO
  FROM REP_DETALLE_REPORTE REP
  , ECLIENT CLI
  , REP_DEST_MAIL DEST
  , REP_MAIL MAIL
  , REP_REPORTE REPORT
  WHERE REP.CLIENTE = CLI.CLICLEF(+)
  AND REP.ID_CRON ='" & rep_id & "' 
  AND mail.ID_MAIL(+) = DEST.ID_DEST
  AND DEST.ID_DEST_MAIL(+) = REP.MAIL_OK
  AND REPORT.ID_REP = REP.ID_REP
  AND NVL(mail.status, 1) = 1
Union All
SELECT REP.NAME, REP.CLIENTE
  , REP.FILE_NAME, REP.CARPETA
  , CLI.CLINOM
  , mail.NOMBRE, mail.MAIL
  , REPORT.COMMAND
  , REP.DAYS_DELETED
  , REPORT.NUM_OF_PARAM
  , REP.DEST_MAIL, to_char(REP.LAST_CONF_DATE_1, 'mm/dd/yyyy') LAST_CONF_DATE_1, to_char(REP.LAST_CONF_DATE_2, 'mm/dd/yyyy') LAST_CONF_DATE_2
    ,REP.PARAM_1,REP.PARAM_2,REP.PARAM_3,REP.PARAM_4
 , mail.client_num
 , REPORT.ID_REP, REPORT.SUBCARPETA
 , REP.CREATED_BY
 ,TERCERO
 FROM REP_DETALLE_REPORTE REP
 , ECLIENT CLI
 , REP_DEST_MAIL DEST
 , REP_MAIL MAIL
 , REP_REPORTE REPORT
 WHERE REP.CLIENTE = CLI.CLICLEF(+)
 AND REP.ID_CRON ='" & rep_id & "' 
 AND  DEST.id_dest_mail=2888
 AND mail.ID_MAIL(+) = DEST.ID_DEST
 AND REPORT.ID_REP = REP.ID_REP
 AND NVL(mail.status, 1) = 1
 and REP.MAIL_OK is not null
 and not exists(  SELECT null FROM REP_DEST_MAIL DESTD, REP_MAIL MAILD
 Where DESTD.id_dest_mail = REP.MAIL_OK
 AND maild.ID_MAIL = DESTD.ID_DEST
 AND maild.status = 1 )
 order by CLIENT_NUM, TERCERO desc , NOMBRE
